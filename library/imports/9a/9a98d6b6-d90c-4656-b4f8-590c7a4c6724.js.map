{"version":3,"sources":["assets\\src\\StartScene.js"],"names":["cc","Class","Component","properties","musicToggle","type","Toggle","settingLayer","Node","balance","Label","loadingLayer","sureToExit","message","prompt","errorButtons","openSureToExit","active","closeSureToExit","onLoad","api","node","getComponent","getSettings","globalData","getSocket","connectSocket","isIOS14Device","sys","os","OS_IOS","isBrowser","isMobile","test","window","navigator","userAgent","MeshBuffer","prototype","checkAndSwitchBuffer","vertexCount","vertexOffset","uploadData","_batcher","_flush","forwardIndiceStartToOffset","switchBuffer","fullScreen","screen","exitFullScreen","requestFullScreen","updateCreditLabel","string","Math","round","settings","start","blankScreen","lobby_url","open","openSetting","closeSetting","toggleMute","isChecked","audioEngine","setMusicVolume","setEffectVolume","update","dt","isKicked","kickMessage"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\nimport * as globalData from \"GlobalData\";\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n\r\n        musicToggle:{\r\n            default:null,\r\n            type:cc.Toggle,\r\n        },\r\n\r\n        settingLayer:{\r\n            default :null,\r\n            type:cc.Node,\r\n        },\r\n\r\n        balance:{\r\n            default:null,\r\n            type:cc.Label,\r\n        },\r\n\r\n        loadingLayer:{\r\n            default:null,\r\n            type:cc.Node,\r\n        },\r\n        sureToExit:{\r\n            default:null,\r\n            type:cc.Node,\r\n        },\r\n        message:{\r\n\t\t\tdefault:null,\r\n\t\t\ttype:cc.Label\r\n\t\t},\r\n        prompt:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n\t\terrorButtons:{\r\n\t\t\tdefault:[],\r\n\t\t\ttype:[cc.Node],\r\n\t\t},\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    openSureToExit(){\r\n        this.sureToExit.active=true;\r\n    },\r\n    closeSureToExit(){\r\n        this.sureToExit.active=false;\r\n    },\r\n    onLoad () {\r\n        this.api = this.node.getComponent(\"API\");\r\n        this.api.getSettings();\r\n        this.loadingLayer.active =true;\r\n        if(!globalData.getSocket()){\r\n            this.getComponent(\"Socket\").connectSocket();\r\n        }\r\n        const isIOS14Device = cc.sys.os === cc.sys.OS_IOS && cc.sys.isBrowser && cc.sys.isMobile && /iPhone OS 14/.test(window.navigator.userAgent);\r\n        if (isIOS14Device) {\r\n            cc.MeshBuffer.prototype.checkAndSwitchBuffer = function (vertexCount) {\r\n                if (this.vertexOffset + vertexCount > 65535) {\r\n                    this.uploadData();\r\n                    this._batcher._flush();\r\n                }\r\n            };     \r\n            cc.MeshBuffer.prototype.forwardIndiceStartToOffset = function () {\r\n                this.uploadData();\r\n                this.switchBuffer();\r\n            }  \r\n        }\r\n    },\r\n    fullScreen(){\r\n\r\n        if(cc.screen.fullScreen()){\r\n            cc.screen.exitFullScreen();\r\n        }\r\n        else{\r\n            cc.screen.requestFullScreen();\r\n        }\r\n      \r\n        // document.webkitExitFullscreen();\r\n    },\r\n\r\n    updateCreditLabel(){\r\n        this.loadingLayer.active=false;\r\n        this.balance.string = Math.round(globalData.settings.balance *100)/100;\r\n    },\r\n    start () {\r\n    },\r\n    blankScreen(){\r\n        if (globalData.settings.lobby_url != null && globalData.settings.lobby_url != \"\") {\r\n            window.open(globalData.settings.lobby_url, \"_self\");\r\n        } else {\r\n            window.open(\"about:blank\", \"_self\");\r\n        }\r\n    },\r\n\r\n    openSetting(){\r\n        this.settingLayer.active  =true;\r\n    },\r\n\r\n    closeSetting(){\r\n        this.settingLayer.active  =false;\r\n\r\n    },\r\n\r\n    toggleMute(){\r\n        if(this.musicToggle.isChecked){\r\n            cc.audioEngine.setMusicVolume(1);\r\n            globalData.setEffectVolume(1);\r\n\r\n        }\r\n        else{\r\n            cc.audioEngine.setMusicVolume(0);\r\n            globalData.setEffectVolume(0);\r\n\r\n\r\n        }\r\n    },\r\n    \r\n    update (dt) {\r\n        if(globalData.isKicked){\r\n\t\t\tthis.errorButtons[0].active = false;\r\n\t\t\tthis.errorButtons[1].active = true;\r\n            this.message.string = globalData.kickMessage;\r\n            this.prompt.active = true;\r\n\t\t}\r\n    },\r\n});\r\n"]}