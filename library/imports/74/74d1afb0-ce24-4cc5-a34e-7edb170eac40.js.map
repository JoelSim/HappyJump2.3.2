{"version":3,"sources":["assets\\src\\Network\\API.js"],"names":["cc","Class","Component","properties","betScene","type","Node","errorLayer","errorLabel","Label","backHome","onLoad","start","startGuestMode","active","global","isDemo","getComponent","updateCreditLabel","getSettings","window","endPointConfig","networkConfig","ecryptContoller","decrypt","networkConfigJson","JSON","parse","geoIP_url","geoip_url","api_url","constant","socketURL","prodSocketURL","host_id","getParameterByName","access_token","xhr","XMLHttpRequest","self","string","onreadystatechange","readyState","status","response","responseText","parsed","settings","data","scheduleOnce","body","json","stringify","apiURL","undefined","isProduction","url","open","setRequestHeader","send","error","message","DemoSettings","isPlayerBalanceUpdated","name","location","href","replace","regex","RegExp","results","exec","decodeURIComponent"],"mappings":"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","sourceRoot":"/","sourcesContent":["import * as global from \"GlobalData\";\r\nimport * as constant from \"Constant\";\r\nimport * as ecrypt from \"Encrypt\";\r\nimport * as ecryptContoller from 'ecrypt_New';\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,      // The default value will be used only when the component attaching\r\n        //                           to a node for the first time\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n\t\t// ...\r\n\t\t\r\n\t\tbetScene:{\r\n\t\t\tdefault:null,\r\n\t\t\ttype:cc.Node,\r\n\t\t},\r\n\r\n\t\terrorLayer:{\r\n\t\t\tdefault:null,\r\n\t\t\ttype:cc.Node,\r\n\t\t},\r\n\t\t\r\n\t\terrorLabel:{\r\n\t\t\tdefault:null,\r\n\t\t\ttype:cc.Label,\r\n\t\t},\r\n\r\n\t\tbackHome:{\r\n\t\t\tdefault:null,\r\n\t\t\ttype:cc.Node,\t\r\n\t\t},\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n    },\r\n\r\n    start(){\r\n        // this.connectAPI();\r\n    },\r\n\tstartGuestMode() {\r\n\t\tthis.errorLayer.active=false;\r\n\t\tglobal.isDemo = true;\r\n\t\tthis.betScene.getComponent(\"StartScene\").updateCreditLabel();\r\n\t},\r\n    getSettings(){\r\n\t\tif(window.endPointConfig != null){\r\n            var networkConfig = ecryptContoller.decrypt(window.endPointConfig);\r\n            if(networkConfig != null){\r\n                var networkConfigJson = JSON.parse(networkConfig);\r\n\r\n                //cc.log(networkConfigJson.geoip_url);\r\n                //cc.log(networkConfigJson.api_url);\r\n\r\n                global.geoIP_url = networkConfigJson.geoip_url;\r\n                global.api_url = networkConfigJson.api_url;\r\n                constant.socketURL = constant.prodSocketURL;\r\n\r\n                // cc.log(global.SetGeoip_Url(networkConfigJson.geoip_url));\r\n                // cc.log(global.SetApi_Url(networkConfigJson.api_url));\r\n            }\r\n        }\r\n\r\n\t\tglobal.host_id = this.getParameterByName('host_id');\r\n\t\tglobal.access_token = this.getParameterByName('access_token');\r\n\t\tlet xhr = new XMLHttpRequest();\r\n\t\tvar self = this;\r\n\r\n\t\tif(global.host_id==null && global.access_token==null){\r\n\t\t\tif(!global.isDemo){\r\n\t\t\t\tself.errorLayer.active = true;\r\n\t\t\t\tself.errorLabel.string=\" You Are Playing For Fun.\";\r\n\t\t\t\txhr.onreadystatechange = function(){\r\n\t\t\t\t\tif(xhr.readyState == 4 &&(xhr.status >= 200 && xhr.status < 400)) {\r\n\t\t\t\t\t\tvar response = xhr.responseText;\r\n\t\t\t\t\t\tvar parsed = JSON.parse(response);\r\n\t\t\r\n\t\t\t\t\t\tglobal.settings = parsed.data;\r\n\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tself.scheduleOnce(function(){\r\n\t\t\t\t\tself.betScene.getComponent(\"StartScene\").updateCreditLabel();\r\n\t\t\t\t\t\r\n\t\t\t\t},0.2);\r\n\t\t\t}\r\n\t\t\r\n\r\n\t\t\tvar body = {\r\n\t\t\t\t\"device_type\": \"Desktop\",\r\n\t\t\t\t\"game_code\": 23,\r\n\t\t\t\t\"country_code\": \"MY\"\r\n\t\t\t}\r\n\t\r\n\t\t\t\r\n\t\t\tvar json = JSON.stringify(body);\r\n\t\t\tvar apiURL= global.api_url;\r\n\t\t\tif (global.api_url == undefined) {\r\n\t\t\t\tapiURL = \"https://bo-stage.slot28.com\";\r\n\t\t\t\tif (global.isProduction) {\r\n\t\t\t\t\tapiURL = \"https://bo.slot28.com\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet url = apiURL+\"/api/user/get-settings-demo\";\r\n\t\t\r\n\t\t\t// let url = \"https://bo-stage-apl.velachip.com/api/user/get-settings?host_id=0e83088027d4c42c8e9934388480c996&access_token=demo01&game_code=21\";\r\n\t\t\txhr.open(\"POST\", url, true);\r\n\t\t\txhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n\t\t\txhr.setRequestHeader(\"Accept-Language\", \"en-US\");\r\n\t\t\txhr.send(json);\r\n\t\t}\r\n\r\n\t\telse{\r\n\t\t\txhr.onreadystatechange = function(){\r\n\t\t\t\tif(xhr.readyState == 4 &&(xhr.status >= 200 && xhr.status < 400)) {\r\n\t\t\t\t\tvar response = xhr.responseText;\r\n\t\t\t\t\tvar parsed = JSON.parse(response);\r\n\t\r\n\t\t\t\t\tglobal.settings = parsed.data;\r\n\t\t\t\t\t// global.setSettings(parsed.data);\r\n\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t//global.balance = global.settings.balance;\r\n\t\r\n\t\t\t\t\tif(global.settings==undefined){\r\n\t\t\t\t\t\tself.errorLayer.active = true;\r\n\t\t\t\t\t\tself.errorLabel.string = parsed.error.message;\r\n\t\t\t\t\t\tglobal.settings=global.DemoSettings;\r\n\t\t\t\t\t\tself.backHome.active=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tglobal.isPlayerBalanceUpdated = true;\r\n\t\t\t\t\t\tself.betScene.getComponent(\"StartScene\").updateCreditLabel();\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// console.log(global.getSettings());\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\r\n\t\t\tvar body = {\r\n\t\t\t\t\"host_id\": this.getParameterByName('host_id'), \r\n\t\t\t\t\"access_token\": this.getParameterByName('access_token'),\r\n\t\t\t\t\"device_type\": \"Desktop\",\r\n\t\t\t\t\"game_code\": 23,\r\n\t\t\t\t\"country_code\": \"MY\"\r\n\t\t\t}\r\n\t\r\n\t\t\tvar json = JSON.stringify(body);\r\n\t\t\tvar apiURL = global.api_url;\r\n\t\t\tif (global.api_url == undefined) {\r\n\t\t\t\tapiURL = \"https://bo-stage.slot28.com\";\r\n\t\t\t\tif (global.isProduction) {\r\n\t\t\t\t\tapiURL = \"https://bo.slot28.com\";\r\n\t\t\t\t}\r\n\t\t\t\tglobal.api_url=apiURL;\r\n\t\t\t}\r\n\r\n\t\t\tlet url = apiURL + \"/api/user/get-settings?host_id=\"+global.host_id+\"&access_token=\"+global.access_token+\"&game_code=23\";\r\n\t\t\t// let url = \"https://bo.slot28.com/api/user/get-settings?host_id=\"+global.host_id+\"&access_token=\"+global.access_token+\"&game_code=23\";\r\n\t\r\n\t\t\t// let url = \"https://bo-stage-apl.velachip.com/api/user/get-settings?host_id=0e83088027d4c42c8e9934388480c996&access_token=demo06&game_code=23\";\r\n\t\t\txhr.open(\"POST\", url, true);\r\n\t\t\txhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n\t\t\txhr.setRequestHeader(\"Accept-Language\", \"en-US\");\r\n\t\t\txhr.send(json);\r\n\t\t}\r\n\t\t\r\n\t},\r\n\tgetParameterByName(name, url) {\r\n\t\tif (!url) url = window.location.href;\r\n\t\tname = name.replace(/[\\[\\]]/g, \"\\\\$&\");\r\n\t\tvar regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\r\n\t\t\tresults = regex.exec(url);\r\n\t\tif (!results) return null;\r\n\t\tif (!results[2]) return '';\r\n\r\n\t\t\treturn decodeURIComponent(results[2].replace(/\\+/g, \" \"));\r\n\t},\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"]}