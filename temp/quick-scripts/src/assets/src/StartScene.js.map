{"version":3,"sources":["assets\\src\\StartScene.js"],"names":["cc","Class","Component","properties","musicToggle","type","Toggle","settingLayer","Node","balance","Label","loadingLayer","sureToExit","message","prompt","errorButtons","openSureToExit","active","closeSureToExit","onLoad","api","node","getComponent","getSettings","isIOS14Device","sys","os","OS_IOS","isBrowser","isMobile","test","window","navigator","userAgent","MeshBuffer","prototype","checkAndSwitchBuffer","vertexCount","vertexOffset","uploadData","_batcher","_flush","forwardIndiceStartToOffset","switchBuffer","fullScreen","screen","exitFullScreen","requestFullScreen","updateCreditLabel","string","Math","round","globalData","settings","start","blankScreen","lobby_url","open","openSetting","closeSetting","toggleMute","isChecked","audioEngine","setMusicVolume","setEffectVolume","update","dt","isKicked","kickMessage"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\nimport * as globalData from \"GlobalData\";\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n\r\n        musicToggle:{\r\n            default:null,\r\n            type:cc.Toggle,\r\n        },\r\n\r\n        settingLayer:{\r\n            default :null,\r\n            type:cc.Node,\r\n        },\r\n\r\n        balance:{\r\n            default:null,\r\n            type:cc.Label,\r\n        },\r\n\r\n        loadingLayer:{\r\n            default:null,\r\n            type:cc.Node,\r\n        },\r\n        sureToExit:{\r\n            default:null,\r\n            type:cc.Node,\r\n        },\r\n        message:{\r\n\t\t\tdefault:null,\r\n\t\t\ttype:cc.Label\r\n\t\t},\r\n        prompt:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n\t\terrorButtons:{\r\n\t\t\tdefault:[],\r\n\t\t\ttype:[cc.Node],\r\n\t\t},\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    openSureToExit(){\r\n        this.sureToExit.active=true;\r\n    },\r\n    closeSureToExit(){\r\n        this.sureToExit.active=false;\r\n    },\r\n    onLoad () {\r\n        this.api = this.node.getComponent(\"API\");\r\n        this.api.getSettings();\r\n        this.loadingLayer.active =true;\r\n        const isIOS14Device = cc.sys.os === cc.sys.OS_IOS && cc.sys.isBrowser && cc.sys.isMobile && /iPhone OS 14/.test(window.navigator.userAgent);\r\n        if (isIOS14Device) {\r\n            cc.MeshBuffer.prototype.checkAndSwitchBuffer = function (vertexCount) {\r\n                if (this.vertexOffset + vertexCount > 65535) {\r\n                    this.uploadData();\r\n                    this._batcher._flush();\r\n                }\r\n            };     \r\n            cc.MeshBuffer.prototype.forwardIndiceStartToOffset = function () {\r\n                this.uploadData();\r\n                this.switchBuffer();\r\n            }  \r\n        }\r\n    },\r\n    fullScreen(){\r\n\r\n        if(cc.screen.fullScreen()){\r\n            cc.screen.exitFullScreen();\r\n        }\r\n        else{\r\n            cc.screen.requestFullScreen();\r\n        }\r\n      \r\n        // document.webkitExitFullscreen();\r\n    },\r\n\r\n    updateCreditLabel(){\r\n        this.loadingLayer.active=false;\r\n        this.balance.string = Math.round(globalData.settings.balance *100)/100;\r\n    },\r\n    start () {\r\n    },\r\n    blankScreen(){\r\n        if (globalData.settings.lobby_url != null && globalData.settings.lobby_url != \"\") {\r\n            window.open(globalData.settings.lobby_url, \"_self\");\r\n        } else {\r\n            window.open(\"about:blank\", \"_self\");\r\n        }\r\n    },\r\n\r\n    openSetting(){\r\n        this.settingLayer.active  =true;\r\n    },\r\n\r\n    closeSetting(){\r\n        this.settingLayer.active  =false;\r\n\r\n    },\r\n\r\n    toggleMute(){\r\n        if(this.musicToggle.isChecked){\r\n            cc.audioEngine.setMusicVolume(1);\r\n            globalData.setEffectVolume(1);\r\n\r\n        }\r\n        else{\r\n            cc.audioEngine.setMusicVolume(0);\r\n            globalData.setEffectVolume(0);\r\n\r\n\r\n        }\r\n    },\r\n    \r\n    update (dt) {\r\n        if(globalData.isKicked){\r\n\t\t\tthis.errorButtons[0].active = false;\r\n\t\t\tthis.errorButtons[1].active = true;\r\n            this.message.string = globalData.kickMessage;\r\n            this.prompt.active = true;\r\n\t\t}\r\n    },\r\n});\r\n"]}